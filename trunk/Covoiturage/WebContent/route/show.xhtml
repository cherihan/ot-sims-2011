<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jstl/core">

<ui:composition template="/template/template.xhtml">

	<ui:define name="title">
		<h:outputText
			value="Trajet #{beansRoute.route.position_beginObj.address} > #{beansRoute.route.position_endObj.address}" />
	</ui:define>

	<ui:define name="body">
		<div class="ride_details">
		<div class="from"><span><h:outputText escape="false" value="De : "/></span><h:outputText
			value="#{beansRoute.route.position_beginObj.address}" /></div>
		<div class="to"><h:outputText escape="false" value="À : "/><h:outputText
			value="#{beansRoute.route.position_endObj.address}" /></div>
		<div class="countdown"><h:outputText escape="false" value="Départ dans : "/><span><h:outputText
			value="#{beansRoute.route.delay_from_now}" />mn</span></div>
		<div class="matching"><h:outputText
			value="#{beansRoute.route.empty_seats}" /> places libres
		#{route.seatDots}</div>
		</div>
		<hr />
		<div>Conducteur :</div>
		<div>
		<div class="people_link"><h:commandButton
			value="#{beansRoute.route.ownerObj.fullname}" styleClass="large" />
		<button class="large">☎</button>
		</div>
		</div>
		<div>Passagers :</div>
		<div>
			<h:panelGroup rendered="#{beansRoute.route.isPassegerListEmpty} and #{!beansRoute.is_my_route}">
				<div><h:outputText escape="false" value="Soyez le premier passager à bord"/></div>
				<div><h:outputText escape="false" value="En cliquant sur le bouton ci-dessous"/></div>
			</h:panelGroup>
			<h:panelGroup rendered="#{beansRoute.route.isPassegerListEmpty} and #{beansRoute.is_my_route}">
				<div><h:outputText escape="false" value="Pas de passager"/></div>
			</h:panelGroup>
			<h:panelGroup rendered="#{!beansRoute.route.isPassegerListEmpty}">
				<ui:repeat value="#{beansRoute.route.passagerslist}" var="passager">
					<div class="people_link"><h:commandButton
						value="#{passager.userObj.fullname}" styleClass="large" />
					<button class="large">☎</button>
					</div>
				</ui:repeat>
			</h:panelGroup>
		</div>
		<h:panelGroup rendered="#{!beansRoute.is_my_route}">
			<div><h:commandButton value="Se joindre au trajet"
				styleClass="large" /></div>
		</h:panelGroup>
		<hr />

		<div><h:outputText escape="false" value="Détails du trajets : "/></div>
		<div class="msg"><h:outputText
			value="#{beansRoute.route.comment}" /></div>

		<hr />
		    <div id="map_canvas" style="width:300px;height:300px;"></div>
    <script type="text/javascript">
      var polyline = new Array();
      <ui:repeat value="#{beansRoute.segments}" var="pos">
          polyline.push({"lat":#{pos.latitude}, "lng":#{pos.longitude}});
      </ui:repeat>
      initializeGoogleMap(polyline);
    </script>
		<h:panelGroup rendered="#{beansRoute.is_created_route}">
			<div><h:commandButton value="Retour" styleClass="large" />
			</div>
		</h:panelGroup>
		<h:panelGroup rendered="#{!beansRoute.is_created_route}">
			<div><h:commandButton value="Autres trajets" styleClass="large" />
			</div>
		</h:panelGroup>
	</ui:define>
</ui:composition>
</html>